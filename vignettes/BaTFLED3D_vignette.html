<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Example usage</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<p>BaTFLED is a machine learning algorithm designed to make predictions and determine interactions in data that varies along three independent modes. For example BaTFLED was developed to predict the growth of cell lines when treated with drugs at different doses. The first mode corresponds to cell lines and incorporates predictors such as cell line genomics and growth conditions. The second mode corresponds to drugs and incorporates predictors indicating known targets and structural features. The third mode corresponds to dose and there are no dose-specific predictors (although the algorithm is capable of including predictors for the third mode if present). </p>

<p>BaTFLED assumes a generative model where matrices of predictors are multiplied through projection matrices to form latent representations of the input data. These latent representations vectors are analogous to principal component vectors. Matrices containing the latent vectors are combined to form the response tensor which, in this case, are measures of the growth of cell lines after treatment with different drugs at different doses.</p>

<p>The algorithm learns distributions on values in the projection matrices and latent matrices using a Bayesian framework. Prior distributions on the projection matrices can encourge a sparse representation of the input data. Values in the model are learned through variational approximation which maximizes a lower bound on the posterior likelihood by iteratively updating values in the model. This process is deterministic given a random initialization and update ordering.</p>

<h2>Example usage</h2>

<p>This document will walk through the use of BaTFLED on a small simulated dataset.</p>

<p>First we check for installation of necessary packages, install them if necessary and load them.</p>

<pre><code class="r">library(BaTFLED3D)

# Set up backend for parallel execution
cores &lt;- 4
if(.Platform$OS.type == &quot;windows&quot;) {
  clust &lt;- parallel::makeCluster(cores)
  doParallel::registerDoParallel(clust)
} else doMC::registerDoMC(cores)
</code></pre>

<h2>Generating a simulated dataset</h2>

<p>Next we generate simulated data according to the assumed generative model which we will try to reconstruct using BaTFLED. Many aspects of model building can be adjusted, use <code>?get_data_params</code> to see them.</p>

<pre><code class="r">args &lt;- list(&#39;decomp=Tucker&#39;,             # Should be either CP or Tucker factorization
             &#39;m1.rows=20&#39;, &#39;m1.cols=80&#39;,  # Dimensions of input matrices
             &#39;m2.rows=25&#39;, &#39;m2.cols=100&#39;,
             &#39;m3.rows=5&#39;, &#39;m3.cols=0&#39;,
             &#39;A1.intercept=T&#39;,            # Add intercepts to projection matrices
             &#39;A2.intercept=T&#39;, 
             &#39;A3.intercept=F&#39;,
             &#39;H1.intercept=T&#39;,            # Add intercepts to latent matrices
             &#39;H2.intercept=T&#39;, 
             &#39;H3.intercept=T&#39;,
             &#39;m1.true=8&#39;,                 # Number of predictors affecting output 
             &#39;m2.true=10&#39;, 
             &#39;m3.true=0&#39;,
             &#39;R1=4&#39;, &#39;R2=4&#39;, &#39;R3=4&#39;,      # Core dimension
             &#39;core.spar=0.1&#39;,             # Amount of sparsity in the core [0-1], 1=no sparsity
             &#39;noise.sd=0.2&#39;               # Amount of Gaussian noise added to responses
)
data.params &lt;- get_data_params(args)
toy &lt;- mk_toy(data.params)
</code></pre>

<p>The <code>toy</code> list contains the input matrices (<code>mode1.X</code>, <code>mode2.X</code> and <code>mode3.X</code>), the sparse projection matrices (<code>mode1.A</code>, <code>mode2.A</code> and <code>mode3.A</code>), the latent matrices (<code>mode1.H</code>, <code>mode2.H</code> and <code>mode3.H</code>), the core tensor (<code>core</code> if a &#39;Tucker&#39; decomposition is used) and the response tensor (<code>resp</code>). The matrices and slices of the tensors can be view using <code>im_mat()</code>. Note that there are normally some patterns visible in the response tensor.</p>

<pre><code class="r">par(mfrow=c(2,2), mar=c(2,2,2,2), mgp=c(1,1,1))
im_mat(toy$mode1.X, main=&#39;Mode 1 X&#39;, ylab=&#39;Samples&#39;, xlab=&#39;Predictors&#39;)
im_mat(toy$mode1.A, main=&#39;Mode 1 A&#39;, ylab=&#39;Predictors&#39;, xlab=&#39;Latent factors&#39;)
im_mat(toy$mode1.H, main=&#39;Mode 1 H&#39;, ylab=&#39;Samples&#39;, xlab=&#39;Constant + latent factors&#39;)
im_mat(toy$resp[,,1], main=&#39;Slice of response tensor&#39;,
       xlab=&#39;Mode 2 samples&#39;, ylab=&#39;Mode 1 samples&#39;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk mode 1 mats" alt="plot of chunk mode 1 mats" style="display: block; margin: auto;" /></p>

<h2>Training a BaTFLED model</h2>

<p>Now that we&#39;ve built a model, let&#39;s see if we can get BaTFLED to learn the values in the projection and latent matrices and the core tensor given just the input data and responses. We separate two of the &#39;samples&#39; from modes 1 and 2 to be used as test data and form <code>input_data</code> objects. We also set a percentage of training responses to <code>NA</code> to be used for &#39;warm start&#39; testing. If the <code>X</code> matrices contain constants they are removed since these is optionally added during training.</p>

<pre><code class="r">train.data &lt;- input_data$new(
  mode1.X=toy$mode1.X[-c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode1.X))],
  mode2.X=toy$mode2.X[-c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode2.X))],
  mode3.X=toy$mode3.X[, !grepl(&#39;const&#39;, colnames(toy$mode3.X))],
  resp=toy$resp[-c(1,2),-c(1,2),])

# Remove &#39;warm.per&#39; percent of responses to be used as &#39;warm&#39; test data
warm.per &lt;- 0.05
warm.idx &lt;- sample(1:prod(dim(train.data$resp)), prod(dim(train.data$resp))*warm.per)
warm.resp &lt;- train.data$resp[sort(warm.idx)]
train.data$resp[warm.idx] &lt;- NA
train.data$delta[warm.idx] &lt;- 0

m1.test.data &lt;- input_data$new(
  mode1.X=toy$mode1.X[c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode1.X))],
  mode2.X=toy$mode2.X[-c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode2.X))],
  mode3.X=toy$mode3.X[, !grepl(&#39;const&#39;, colnames(toy$mode3.X))],
  resp=toy$resp[c(1,2),-c(1,2),])
m2.test.data &lt;- input_data$new(
  mode1.X=toy$mode1.X[-c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode1.X))],
  mode2.X=toy$mode2.X[c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode2.X))],
  mode3.X=toy$mode3.X[, !grepl(&#39;const&#39;, colnames(toy$mode3.X))],
  resp=toy$resp[-c(1,2),c(1,2),])
m1m2.test.data &lt;- input_data$new(
  mode1.X=toy$mode1.X[c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode1.X))],
  mode2.X=toy$mode2.X[c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode2.X))],
  mode3.X=toy$mode3.X[, !grepl(&#39;const&#39;, colnames(toy$mode3.X))],
  resp=toy$resp[c(1,2),c(1,2),])
</code></pre>

<p>To train BaTFLED we create and initialize a <code>model</code> object. Again there are a lot of parameters to specify, a subset of which are indicated below. To see all available parameters, their descriptions and defaults run <code>?get_model_params</code>. Note: decomp=CP is not currently implmented.</p>

<pre><code class="r">args &lt;- list(&#39;decomp=Tucker&#39;, &#39;row.share=T&#39;,
             &#39;A1.intercept=T&#39;, &#39;A2.intercept=T&#39;, &#39;A3.intercept=F&#39;,
             &#39;H1.intercept=T&#39;, &#39;H2.intercept=T&#39;, &#39;H3.intercept=T&#39;,
             &#39;plot=F&#39;, &#39;verbose=F&#39;,
             &#39;R1=4&#39;, &#39;R2=4&#39;, &#39;R3=4&#39;,
             &#39;sigma2=auto&#39;,
             &#39;m1.alpha=1e-10&#39;, &#39;m2.alpha=1e-10&#39;, &#39;m3.alpha=1&#39;,
             &#39;m1.beta=1e10&#39;, &#39;m2.beta=1e10&#39;, &#39;m3.beta=1&#39;,
             &#39;core.0D.alpha=1&#39;, &#39;core.0D.beta=1&#39;, 
             &#39;core.1D.alpha=1e-4&#39;, &#39;core.1D.beta=1e4&#39;,
             &#39;core.2D.alpha=1e-8&#39;, &#39;core.2D.beta=1e8&#39;,
             &#39;core.3D.alpha=1e-12&#39;, &#39;core.3D.beta=1e12&#39;,
             &#39;parallel=T&#39;, &#39;cores=4&#39;, &#39;lower.bnd=T&#39;, 
             &#39;update.order=c(3,1,2)&#39;, &#39;show.mode=c(1,2,3)&#39;)
model.params &lt;- get_model_params(args)
model &lt;- mk_model(train.data, model.params)
model$rand_init(model.params)
</code></pre>

<pre><code>## [1] &quot;** Initialization complete **&quot;
</code></pre>

<p><code>model</code> is an <code>R6</code> object containing A mean matrices (ex. <code>model$mode1.A.mean</code>), A covariance arrays (ex. <code>model$mode1.A.cov</code>), H mean and variance matrices (ex. <code>model$mode1.H.mean</code> and <code>model$mode1.H.var</code>), arrays for the core mean and variance (<code>model$core.mean</code> and <code>model$core.var</code>), an array of predicted responses (<code>model$resp</code>) and parameters for the prior distributions. Initially these are random values sampled from Gaussian distributions.</p>

<pre><code class="r">par(mfrow=c(2,2), mar=c(2,2,2,2), mgp=c(1,0,5))
im_mat(model$mode1.A.mean, main=&#39;Mode 1 A mean&#39;, xlab=&#39;Latent factors&#39;, ylab=&#39;Predictors&#39;)
im_mat(model$mode2.A.mean, main=&#39;Mode 2 A mean&#39;, xlab=&#39;Latent factors&#39;, ylab=&#39;Predictors&#39;)
im_mat(model$mode3.H.mean, main=&#39;Mode 3 H mean&#39;, xlab=&#39;Latent factors&#39;, ylab=&#39;Samples&#39;)
if(model.params$decomp==&#39;Tucker&#39;)
  im_mat(model$core.mean[,,1], main=&#39;Core mean&#39;, xlab=&#39;mode 2 latent&#39;, ylab=&#39;Mode 1 latent&#39;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk image model" alt="plot of chunk image model" style="display: block; margin: auto;" /></p>

<p>We&#39;re now ready to train the BaTFLED model. If <code>params$plot=TRUE</code> the predictions and some of the learned matrices will be displayed during training. You can adjust which A and H matrices are displayed by changing <code>params$show.mode</code>. The observed response values for the &#39;warm&#39; data are set to zero, so they appear along a vertical line in the first plot. You may want to adjust the number of <code>cores</code> depending on how many processors you have on your machine and the number of iterations run <code>reps</code>. With <code>50</code> iterations a Tucker decomposition will take about <code>10</code> minutes.</p>

<pre><code class="r">reps &lt;- 50

# Data frame to store RMSEs &amp; explained variances for test data while training 
test.results &lt;- numeric(0)

trained &lt;- model$clone()

for(i in 1:reps) {
train(d=train.data, m=trained, params=model.params)

# Get cold results
test.results &lt;- test_results(m=trained, d=train.data, test.results=test.results,
warm.resp=warm.resp, test.m1=m1.test.data, test.m2=m2.test.data, 
test.m1m2=m1m2.test.data)
}

# Stop cluster (if using parallel package)
if(.Platform$OS.type == &quot;windows&quot;) parallel::stopCluster(clust)
</code></pre>

<h2>Exploring the resulting model</h2>

<p>Now that the model has been trained, let&#39;s compare the learned matrices to the generating <code>toy</code> model. Since the latent factors (columns of the A &amp; H matrices) can be permuted or scaled without changing predictions, the function <code>im_2_mat</code> scales and reorders columns of the two matrices and tries to match the latent factors. The new ordering for the second matrix is returned (with negatives indicating negative scaling) so that it can be used to order the core.</p>

<pre><code class="r">par(mfrow=c(3,4), mar=c(2,2,2,2))
im_2_mat(toy$mode1.A, trained$mode1.A.mean, main1=&#39;Mode 1 A true&#39;, main2=&#39;Mode 1 A learned&#39;)
m1.H.order &lt;- im_2_mat(toy$mode1.H[-(1:2),], trained$mode1.H.mean, 
                       main1=&#39;Mode 1 H true&#39;, main2=&#39;Mode 1 H learned&#39;)
im_2_mat(toy$mode2.A, trained$mode2.A.mean, main1=&#39;Mode 2 A true&#39;, main2=&#39;Mode 2 A learned&#39;)
m2.H.order &lt;- im_2_mat(toy$mode2.H[-(1:2),], trained$mode2.H.mean, 
                       main1=&#39;Mode 2 H true&#39;, main2=&#39;Mode 2 H learned&#39;)
m3.H.order &lt;- im_2_mat(toy$mode3.H, trained$mode3.H.mean, 
                       main1=&#39;Mode 3 H true&#39;, main2=&#39;Mode 3 H learned&#39;)
if(model.params$decomp==&#39;Tucker&#39;) {
  core.reorder &lt;- trained$core.mean[abs(m1.H.order), abs(m2.H.order), abs(m3.H.order)]
  core.reorder &lt;- core.reorder * outer(sign(m1.H.order), outer(sign(m2.H.order), sign(m3.H.order)))
  im_2_mat(toy$core[,,1], core.reorder[,,1], sort=F, center=T, scale=&#39;all&#39;,
           main1=&#39;Core mode 1 slice true&#39;, main2=&#39;Core mode 1 slice learned&#39;)
}
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk compare model matrices" alt="plot of chunk compare model matrices" style="display: block; margin: auto;" /></p>

<p>To quantify how well BaTFLED has chosen predictors we can generate receiver operating characteristic (ROC) curves for each of the modes with predictors. Predictors are &#39;chosen&#39; if the sum of squared values in the corresponding row of the scaled A matrix is large.</p>

<pre><code class="r">par(mfrow=c(1,2), mar=c(3,3,2,2), mgp=c(2,1,0))
plot_roc(toy$mode1.A, trained$mode1.A.mean, main=&#39;Mode 1&#39;)
plot_roc(toy$mode2.A, trained$mode2.A.mean, main=&#39;Mode 2&#39;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbAAAAEgCAMAAADi9tZbAAAAkFBMVEUAAAAAACsAAFUAKysAK1UAK4AAVaorAAArACsrAFUrKwArKysrK4ArVVUrgIArgNRVAABVACtVAFVVKwBVKytVVStVVVVVqv+AKwCAKyuAgCuAgFWAqoCA1KqA1NSA1P+qVQCqqlWq1ICq/6qq/9Sq///UgCvU1IDU/9TU////AAD/qlX/1ID//6r//9T///9KxK+BAAAACXBIWXMAAAsSAAALEgHS3X78AAAPM0lEQVR4nO2di3bbuBGGKTWmN61TOtntym63KzVZaVembL7/2xUX3iSS4gwIgDM48x8nlghyhE8/MQDBi7NKxErZ2hUQ4SSGMZMYxkxiGDOJYcwkhjGTGMZMYhgziWHMBDLs/JBlJ/W7yLKXj+ui4/Z2SVXtN4felgez1vO7fvP8ftxmWvptZV7bzc3L08RHN9H0Sof6tw7QvHcWjiuvqx2KqzARsrLlGxXQsMe/qQroD4GBtV/jflN/tTdgOo4q03q8VNXOLhz59vNuud30VP9++WjeuwvFlbeGBOIqsj7XsB1YQQ37omp23P5ro+MU9fekQf+3bZaUzbrZP7oaFtmvuqAP1oDWO2muqqZenvS6mrG3p5kvptlE0x9MiP1GQz1emvcQguVc+hNVQRmOy7xWqzZ843WGGvbbplSR/6PB8nqv0Vx2V7BL7L5+fjLfZLPh8391fhwD25svSce+2Jfnh7K6BTOhclt5C2bX1gGa93CDlnCZOtY1CcNV6e1PVdXwjdcZath3FapQtXz52G9UbL0H6L1E1UIvMXml/YjOMNWbmeXD1HFo18qzcjeZ2ExJbiHrTUtLXnbvnYXkUrWpE1UYLrXEfFZxDwtq2CV/+evh5XeFYCtU6OocbK6vM3W7r3eGFebrLYdgZTUNdr0ndmC6c3j8ol7n9X7fvHcWmqt5GYZLhTvYLe/0zWDDiucf29MeZ1idXA5VlzDsv6xu+RUmddivoem76mX5wpSI4CraV2G47H5wlSJHBDZsv/nV1mAidfTUGlaPl0xHfLIZxSCq5WXV65wtafeFdOp3zvbDm74rK5v3EAIPXEU31A7D1bjU8I3XGWyY+vC6Q53qnFu61rDCNOy86XbsmFzX0sBjhr/18CvrhvXde3dhuPo9ZhiuOkbLN15nsGHqIw51c+8Pf/9thr9536/WsHo3KfTb3VWl7F5oago7wDSb6ZVO1fWB8xK/UFy7LqGF4mpa9PIDZxEdiWHMJIYxkxjGTGIYM4lhzCSGMZMYxkwYwzJq8vUdUNPdyg6WtBNlgHXXFa4+iXANCpu55d3wHDUrsFulwjUoPH57v/oNDRRdb7j6pMLFtoW9JdrC5riGhf0LtubWXVe4+iTChRolLqyIb3kbJXqK40spGvam/0vQsHmuycJ+5zw8Poh9ZHIrd8N6XG20ia+GJJdjCyOxUwZuYasximFuccQwb3rzWwkyhkG4OBr25rkSVAwDcQ1nOuprjkcOWKgY1gg30wHicg7vU8gWdn4AXCXMzzAYl3t4j8KmxOPn+auEVzTsrX2FrASEC7A4lIBc7PqwjiutPgzKxc6wnpIyDPrBYpgYFlJv/TcJGQbnEsPEsGhKyDD4B4thYlg4vV2/TcYwDBcnw264kjEMxcXJsFulYhjqg8Ww6zj907+ewi+qD65wet0VYG4TRyDDPMWEC8nFxrAhVxqGYbnYGDaiJAwbkRiGiEMBzL9h8TvkkcSRhGF4LjfDEBv5kRgGKpxal0LeqJIwbFRiGCIOBTT+ho0mjgQMc+HiYNgEF3vDnLg4GDYl7oZNSQxDxKGAxtywqcTB3TBHLvKGTXPxNsyVa1i432SH4v69wBTyRoWtBoALHTOMcIadny5VcVB8r9N321OgqpDVgHBhYwYSzjB9S2lxuv88CwqJvkJWA8KFjekudy7iLcyfYbRamEfDdK4/JdqH3eda97qAnniPEu/I8yiRCBVnw+4mDsaGLeGaLLz3nA4Kib5yrMb0czooHIIZ8W1hM2LbwmYkhsHiEKFyGSWO32wf2bC5xOEwSrzPRSTRo4/DAM8VjIE2z4U8DpvlimPYUq7RmY7+7+G6NA5WKoeZjv7vYRwiVP5bGA+wW6XCNSycfXInkYSIrUgiXA6jRB5gCLHiImoYSAwNA0kMg8XhwUXSMFDiYGiYDy6KhgG52BnmhYuiYVBxMwwqgGHnh+zlj6mn090G4gFmlCCXKTw/nPavHyOHlKOBAoNBEwegIilymcLjt3cFNjJpMxooLBica74iKXL1WlhBY0+EC9jC0uJq+7D+36a/H4gHmFGCXMRGiYjEwWqU6I+r6cOq0RMPo4F4gGmlyJX1nuieVK5PlavXwqCBeIBppchFqg9DJQ5GfZhPLltYTJ3bGwsUDAzJBahIglw2JX6+7A7mVgFIIB6pQytFrqYPsz+gQDzAtFLksjMdTxf1s/+6Khg2cUBmOhLksoWKaZdlU3/95yZQGDA8F6AiCXKRGiUixWaUiJQch8Hi8OBq+jBEoBBgDokD1och4vDgsi1s8hrLsUA8wLRS5BoW7jelPisxMgHHKnUMlAjXoFBfg56X9+625wF2q1S4BoWqozapP+ZdHk6JA1mRVLiGhWo33Kkjl91wQicUmCMXsiKJcI0U5qanHpmAY5U6hkqDyxYmeP2eUYJc9jhszev3XBMH5DgsQa5mpmNw/d70czr8grlzgWY67nEFfU5HKK5eC0vr+j2tFLnaPiy16/eMEuQam+mIeC/wgsSBn+lIgmt0pkMrzt328QxLhaue/O0oUnmehVaKXHWhzhf2kDKV51lYpcfVK9zZ9B7xeRaLEge4ImlxDVrY/LrewBZy4VrYfBweXIM+bG5dMk+aQvZh83F4cGFqmWE3CCxfVeFm2PHbD8SpdDKJY7YqOC5vZIG5Vmthy7lotrDQXM3kbwW4KIxdSqRzQx9KsykRdeMbGaz5lCg39M1GA8tD4gC3MGgcH2ThuVbqw+IYhovDxrCVRonLRXOUuFwUW5gXEWxhXkTPMC+Jg6BhMbhsYfHyUWRZCQnk4VvyxAWoCoLLA1kULjtK/HxRP7A7FckkDsgoEcFFiAw0rFf7YoKGIbgIkUFSYvZ42UVKib4SByglwrkWk0Xiij7o8MdFa9ARi0uG9SxTIuL6PTJYkKqkel3i+UE/GQF2hSyZxAGoCoZrGVk8rsinV+IaFu/0SmTD4rUwryLUwrxK+jBYHDJkdEaJXhMHoVFiTK6YhnnmImNYVK5eSjz0Fo9O5zBNiTAuQmTgQYcha6+EGJ72Y2cYhosQGXJYf9wqpAAtzHfiwA7rZ7icySJz1ZO/h+Y/reP25Xfvhvnngkz+wrlcyWJz2RZ2my72m7HrINilRAwXITIyo0TfojJK9C0KhgVIHCQMi881WTj1nA7uhvl9Tgchw6bWJZM4SLSwIBLDYHHIkMFmOtqHaM08z4JM4gDOdEC5XMjW4GpmOtqHaM3dbe9gWCAu0EwHmMuBbBWuZqajfYjW3PMsyCQO2EwHmIsQGbSFFaFaWCgBWxiMixAZ8gTmzPMsyCQO7AlM38/pWIkr+CgxHJffUSL2cRZrccmwnhlXf/I3sRv60uTqFRagP9tEJnGAq5IWV68wxHWJFAxLi6tXuEsqdXRKi6vfh8W6A9OXoH1YUlxBR4lBE8eKo8Q1uZqpKXAgBFhgLtDUFDgOFy47NYX4S3ZcUodWilxyHMaMK1wfFjpxrNWHrcyVgTM9Eiw811xV0uQKZlgErWJYBIlhkDhcuLK7twmMBIKBRUgc84YlyRWoha0PliqXpERmXGIYM64gx2FREscKx2EUuEIYFokrumEkuILO1gfWarP1gSWGQeJw4fJvWKzEEdswIlzeDYvHFdcwKlzDwv0me7ykcW39lRLhGhTqa9D18y24g90qFa5BoQXKD25gERMH8jtOhWu0hSkVfx8+0YIV2K1S4RoWHrfmStkigUcXXSkRLjkOY8bl1bCoiSOiYZS4JgsdntMRmcvNsKnndHDhkpTIjEsMY8Y1OtPhdI9z7MThMNORAtfUcRj6KQLxuZyOw9hzTcx08J9zu1UqXN5a2AqK0sJWEHqmwyHXr5A48DMdSXB5GiXSA8PG4cIlw3pmXGIYMy4vhq2SOCIYRpHLh2ErcQU3jCSXpERmXGIYM67lhq2VOEIbRpRrsWHrcYU1jCqXpERmXGIYM66Fhq2YOIIaRpdLDGPGJSmRGZcYxoxrkWGrJo6AhlHmWmLYylzBDCPNJSmRGZcYxozL3bC1E0cow4hzORu2PlcYw6hzSUpkxiWGMeNyNIxA4ghiGH0uMYwZ17AwwF+ZDSRcVRLhGhSmcg36rVLhGhRC7vIgkTiQ33EqXC4tjAiX9xbGgmtY6PuvzIYTriqJcMlxGDMuvGFUEodvw5hwTRZOPaeDDpebYVPP6eDChW5hhOS1hRGSGBYpji/5nOkglDi8znTw4UIeh/EBu1UqXOiZDkLyOtNBSH5nOgjJ60wHIfmb6SCVODzOdHDiwkC/ZcS08IthyYWGvrPBdJHTRm7xXMWFSwwLVA8xDLiRq7hwiWGB6iGGATdyFRcuMSxQPcQw4Eau4sJF7ShfNCMxjJnEMGYSw5hJDGMmMYyZxDBmEsOYSQxjJjGMmcCGHbdZfTVE9wqxUXdRBWar/WbslL5XceOCGqarVRyuXyE2UioyIFi31fHzpSqgX6Kb2HFBDdNXh+3Nn0DuXiE2UjvVL5+AYN1W+9ePscvSfIodF9Qw8xlqx+i/QmxUnZ/+hKaObqsILYwdF9QwfTmf/bTuFWKjqjiBc31vK0S34ih2XJFamHoFButt9dOl2oUddbDjitSHFeZ6uxPyoxA7vavYccFHiad2NHWCj6Z6q4L3xG6rCC2MHRfyOEzvIejjFbtbYY9X9Fa7LHsM2sD4cclMBzOJYcwkhjGTGMZMYhgziWHMtNwwe3d+c+wIPPQ0K9qfu6ssrp27iHJ5MOzq4zGVmVt3ZcNocvkzTO+RZXNYqA/j1XGiPZo/fvunOU6sF9ji/dcf6u33r99fP6rz06Vdef/Lp+d3E8ssapdHF1Eub4bpuTGbC/ScmZ6CyZuZmOP25UPPxKgFu5ePurhJHX88XfS0aLvyflP2YnVBoosol6c+zH62qrMGq08hqF/2LN1xW5qdTb1RC+viNtcXquqnbuVmx+5iBT6FyYzLYx+W65Sg3ylUlSnMYxYem/N1VV7qorPe70xxC7Z//ctkjnplG66J1S2PLqJc/lLitmyae1U1KcJKg3V7Yl3cgp2ffnvtrWynYcteGlpJRLm8GWZ2wZ8u6pc+26P/2dSuwbaH3oK6uBv+Fnrs3K5s4rSxuuXRRZTLX0ossuznTyY/5O1o6rHO+l/6o6m8Hk29nx/UaMog9FY24WwsVf7eLo8uolwxZjoCnzReTatwiWHuWoXr/xBChrjT1EW3AAAAAElFTkSuQmCC" title="plot of chunk ROC curves" alt="plot of chunk ROC curves" style="display: block; margin: auto;" /></p>

<p>BaTFLED optionally stores values of the lower bound (<code>lower.bnd</code>), root mean squared error (<code>RMSE</code>), explained variation (<code>exp.var</code>), Pearson correlation (<code>p.cor</code>) and Spearman correlation (<code>s.cor</code>) for training data.</p>

<pre><code class="r">par(mfrow=c(2,2), mar=c(3,3,2,2), mgp=c(2,1,0))
if(model.params$lower.bnd) plot(trained$lower.bnd, main=&#39;Lower bound&#39;)
if(model.params$RMSE)      plot(trained$RMSE, main=&#39;Training RMSE&#39;)
if(model.params$exp.var)   plot(trained$exp.var, main=&#39;Training explained variation&#39;)
if(model.params$cor)       plot(trained$s.cor, main=&#39;Spearman correlation&#39;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk training measures" alt="plot of chunk training measures" style="display: block; margin: auto;" /></p>

<p>Also the <code>test.results</code> object in the training loop has stored results for the test data which can be plotted with the functions below.</p>

<pre><code class="r">par(mfrow=c(2,2))
plot_test_RMSE(test.results, main=&quot;Test RMSEs&quot;)
plot_test_exp_var(test.results, main=&quot;Test explained variances&quot;)
plot_test_cor(test.results, main=&quot;Pearson correlation&quot;)
plot_test_cor(test.results, main=&quot;Spearman correlation&quot;, method=&#39;spearman&#39;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-2" alt="plot of chunk unnamed-chunk-2" style="display: block; margin: auto;" /></p>

</body>

</html>
